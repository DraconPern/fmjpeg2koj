image: Visual Studio 2017

configuration:
  - Release

install:
  - SET TYPE=%CONFIGURATION%
  - SET DEVSPACE=%APPVEYOR_BUILD_FOLDER%
  - SET GENERATOR="Visual Studio 15 2017"
  
# dcmtk & zlib
  - cd %DEVSPACE%
  - git clone --branch=DCMTK-3.6.5 --single-branch --depth 1 https://github.com/DCMTK/dcmtk.git

# openjpeg
  - cd %DEVSPACE%
  - git clone --branch=v2.4.0 --single-branch --depth 1 https://github.com/uclouvain/openjpeg.git

build_script:
  - cd %DEVSPACE%
  - build.bat

after_build:
  - cd %DEVSPACE%
  - 7z a fmjpeg2koj-win.7z %TYPE%

artifacts:
  - path: fmjpeg2koj-win.7z
    name: fmjpeg2koj-win